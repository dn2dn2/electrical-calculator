<!DOCTYPE html>
<html lang="vi">
<head>
	<link rel="icon" type="image/png" href="favicon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>C√îNG C·ª§ T√çNH TO√ÅN ƒêI·ªÜN CHUY√äN NGHI·ªÜP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 0;
        }

        /* NAVIGATION */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
        }

        .nav-logo {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-menu {
            display: flex;
            gap: 10px;
            list-style: none;
        }

        .nav-menu li {
            position: relative;
        }

        .nav-link {
            padding: 10px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #333;
        }

        .nav-link:hover {
            background: #f0f4ff;
            color: #667eea;
        }

        .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #667eea;
        }

        /* CONTAINER */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* SECTIONS */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* CARDS & COMMON STYLES */
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 10px;
        }

        button:hover {
            transform: scale(1.02);
        }

        button:active {
            transform: scale(0.98);
        }

        .result {
            margin-top: 15px;
            padding: 15px;
            background: #f0f4ff;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result-value {
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
        }

        .result-label {
            color: #666;
            margin-bottom: 5px;
        }

        .formula {
            font-size: 0.85em;
            color: #888;
            margin-top: 5px;
            font-style: italic;
        }

        .input-params {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .input-params h2 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .params-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .phase-selector {
            grid-column: 1 / -1;
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 10px;
        }

        .phase-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .phase-option input[type="radio"] {
            width: auto;
            cursor: pointer;
            transform: scale(1.5);
        }

        .phase-option label {
            margin: 0;
            cursor: pointer;
            font-size: 1.1em;
        }

        .phase-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }

        .badge-1phase {
            background: #3498db;
            color: white;
        }

        .badge-3phase {
            background: #e74c3c;
            color: white;
        }

        .auto-calc-button {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%) !important;
            margin-top: 20px;
            font-size: 1.2em !important;
        }
        
        .reset-button {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%) !important;
            margin-top: 10px;
        }
        
        .auto-update-wrapper {
            text-align: center;
            margin-top: 15px;
            padding: 10px;
            background: #f0f4ff;
            border-radius: 8px;
        }

        .auto-update-wrapper input[type="checkbox"] {
             width: auto;
             transform: scale(1.2);
             margin-right: 10px;
             cursor: pointer;
        }

        .auto-update-wrapper label {
            display: inline-block;
            color: #333;
            font-weight: 600;
            cursor: pointer;
            margin: 0;
        }

        /* ADVANCED CALCULATOR STYLES */
        .tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            padding: 15px 30px;
            background: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            width: auto;
            color: #333;
        }

        .tab-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            background: #f0f4ff;
            color: #667eea;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .quick-select {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .quick-btn {
            padding: 6px 12px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
            width: auto;
			color: #333;
        }

        .quick-btn:hover {
            background: #667eea;
            color: white;
        }

        .result-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f0f4ff 0%, #e8efff 100%);
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }

        .result-section.hidden {
            display: none;
        }

        .result-title {
            color: #667eea;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #ffc107;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }

        .formula-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #666;
            border: 1px dashed #ddd;
        }

        .info-badge {
            display: inline-block;
            padding: 4px 10px;
            background: #667eea;
            color: white;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .grid-2col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        table tr:hover {
            background: #f5f5f5;
        }

        /* FOOTER */
        .footer {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 30px;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .footer p {
            color: #666;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .footer-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
            padding: 20px 0;
            border-top: 2px solid #f0f0f0;
            border-bottom: 2px solid #f0f0f0;
        }

        .footer-item {
            padding: 10px;
        }

        .footer-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .footer-item span {
            color: #333;
            font-size: 1.1em;
        }

        .footer-copyright {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
            color: #888;
            font-size: 0.9em;
        }

        .footer-badge {
            display: inline-block;
            padding: 8px 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-weight: 600;
            margin: 10px 5px;
            font-size: 0.85em;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                flex-direction: column;
                padding: 20px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            }

            .nav-menu.active {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .grid-2col {
                grid-template-columns: 1fr;
            }

            .footer-info {
                grid-template-columns: repeat(2, 1fr);
            }

            .tabs {
                flex-direction: column;
            }

            .tab-btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .footer-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- NAVIGATION BAR -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                ‚ö°THIETKETUDIEN.VN
            </div>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
            <ul class="nav-menu" id="navMenu">
                <li><button class="nav-link active" onclick="showSection('basic')">üîß T√≠nh To√°n C∆° B·∫£n</button></li>
                <li><button class="nav-link" onclick="showSection('advanced')">‚öôÔ∏è T√≠nh To√°n N√¢ng Cao</button></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- SECTION 1: BASIC CALCULATIONS -->
        <div id="basic" class="section active">
            <div class="header">
                <h1>‚ö° C√îNG C·ª§ T√çNH TO√ÅN ƒêI·ªÜN</h1>
                <p>T√≠nh to√°n nhanh v√† ch√≠nh x√°c c√°c th√¥ng s·ªë ƒëi·ªán</p>
            </div>

            <div class="input-params">
                <h2>Th√¥ng S·ªë ƒê·∫ßu V√†o</h2>
                
                <div class="phase-selector">
                    <div class="phase-option">
                        <input type="radio" id="phase1" name="phase" value="1">
                        <label for="phase1">üîµ M·∫°ng 1 Pha</label>
                    </div>
                    <div class="phase-option">
                        <input type="radio" id="phase3" name="phase" value="3" checked>
                        <label for="phase3">üî¥ M·∫°ng 3 Pha</label>
                    </div>
                </div>

                <div class="params-grid">
                    <div class="input-group">
                        <label>ƒêi·ªán √°p V</label>
                        <input type="number" id="voltage" step="0.01" placeholder="220V (1 pha) ho·∫∑c 380V (3 pha)">
                    </div>
                    <div class="input-group">
                        <label>D√≤ng ƒëi·ªán I (A)</label>
                        <input type="number" id="current" step="0.01" placeholder="Nh·∫≠p d√≤ng ƒëi·ªán">
                    </div>
                    <div class="input-group">
                        <label>C√¥ng su·∫•t kW</label>
                        <input type="number" id="kw" step="0.01" placeholder="Nh·∫≠p kW">
                    </div>
                    <div class="input-group">
                        <label>C√¥ng su·∫•t kVA</label>
                        <input type="number" id="kva" step="0.01" placeholder="Nh·∫≠p kVA">
                    </div>
                    <div class="input-group">
                        <label>C√¥ng su·∫•t kVAR</label>
                        <input type="number" id="kvar" step="0.01" placeholder="Nh·∫≠p kVAR">
                    </div>
                    <div class="input-group">
                        <label>C√¥ng su·∫•t HP</label>
                        <input type="number" id="hp" step="0.01" placeholder="Nh·∫≠p HP">
                    </div>
                    <div class="input-group">
                        <label>H/s·ªë c√¥ng su·∫•t (Cos œÜ - pF)</label>
                        <input type="number" id="pf" step="0.01" min="0" max="1" placeholder="0.8 - 1.0">
                    </div>
                    <div class="input-group">
                        <label>Hi·ªáu su·∫•t Eff (%)</label>
                        <input type="number" id="eff" step="0.01" min="0" max="100" placeholder="80 - 95">
                    </div>
                </div>

                <button onclick="autoCalculateAll()" class="auto-calc-button">
                    T√çNH TO√ÅN T·∫§T C·∫¢
                </button>
                
                <button onclick="resetAllInputs()" class="reset-button">
                    X√≥a t·∫•t c·∫£ th√¥ng s·ªë
                </button>

                <div class="auto-update-wrapper">
                    <input type="checkbox" id="autoUpdate">
                    <label for="autoUpdate">T·ª± ƒë·ªông c·∫≠p nh·∫≠t khi thay ƒë·ªïi th√¥ng s·ªë</label>
                </div>
            </div>

            <div class="calculator-grid">
                <div class="card">
                    <h2>T√≠nh Amperes (A)</h2>
                    <button onclick="calcAFromKVA()">A t·ª´ kVA, V <span id="badge-a-kva" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-a-kva" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>

                    <button onclick="calcAFromKW()">A t·ª´ kW, V, pF <span id="badge-a-kw" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-a-kw" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>

                    <button onclick="calcAFromHP()">A t·ª´ HP, V, Eff, pF <span id="badge-a-hp" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-a-hp" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>

                    <button onclick="calcAFromKVAR()">A t·ª´ kVAR, V <span id="badge-a-kvar" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-a-kvar" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>
                </div>

                <div class="card">
                    <h2>T√≠nh kW (Kilowatts)</h2>
                    <button onclick="calcKwFromIVpF()">kW t·ª´ I, V, pF <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kw-ivpf" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>

                    <button onclick="calcKwFromKVApF()">kW t·ª´ kVA, pF <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kw-kvapf" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula">kW = kVA √ó pF</div>
                    </div>

                    <button onclick="calcKwFromHPEff()">kW t·ª´ HP, Eff <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kw-hpeff" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula">kW = (HP √ó 0.746) / (Eff/100)</div>
                    </div>
                </div>

                <div class="card">
                    <h2>T√≠nh kVA (Kilovolt-Amperes)</h2>
                    <button onclick="calcKVAFromIV()">kVA t·ª´ I, V <span id="badge-kva-iv" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kva-iv" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>

                    <button onclick="calcKVAFromKWpF()">kVA t·ª´ kW, pF <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kva-kwpf" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula">kVA = kW / pF</div>
                    </div>

                    <button onclick="calcKVAFromHPEffpF()">kVA t·ª´ HP, Eff, pF <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kva-hpeffpf" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula">kVA = (HP √ó 0.746) / (Eff/100 √ó pF)</div>
                    </div>
                </div>

                <div class="card">
                    <h2>T√≠nh kVAR (Reactive Power)</h2>
                    <button onclick="calcKVARFromKWKVA()">kVAR t·ª´ kW, kVA <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-kvar-kwkva" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula">kVAR = ‚àö(kVA¬≤ - kW¬≤)</div>
                    </div>
                </div>

                <div class="card">
                    <h2>T√≠nh HP (Horsepower)</h2>
                    <button onclick="calcHPFromIVEffpF()">HP t·ª´ I, V, Eff, pF <span id="badge-hp-iveffpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-hp-iveffpf" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>

                    <button onclick="calcHPFromKVAEffpF()">HP t·ª´ kVA, Eff, pF <span id="badge-kw-ivpf" class="phase-badge badge-1phase">1 Pha</span></button>
                    <div id="result-hp-kvaeffpf" class="result" style="display:none;">
                        <div class="result-label">K·∫øt qu·∫£:</div>
                        <div class="result-value"></div>
                        <div class="formula"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 2: ADVANCED CALCULATIONS -->
        <div id="advanced" class="section">
            <div class="header">
                <h1>‚öôÔ∏è C√îNG C·ª§ T√çNH TO√ÅN N√ÇNG CAO</h1>
                <p>T·ªïn th·∫•t ƒëi·ªán √°p ‚Ä¢ T·ª• b√π ‚Ä¢ ƒê·ªông c∆°</p>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('voltage-drop')">
                    üìâ T·ªïn Th·∫•t ƒêi·ªán √Åp
                </button>
                <button class="tab-btn" onclick="switchTab('capacitor')">
                    üîã T√≠nh T·ª• B√π
                </button>
                <button class="tab-btn" onclick="switchTab('motor')">
                    üè≠ ƒê·ªông C∆°
                </button>
            </div>

            <!-- TAB 1: T·ªîNG TH·∫§T ƒêI·ªÜN √ÅP -->
            <div id="voltage-drop" class="tab-content active">
                <div class="card">
                    <h2>üìâ T√≠nh T·ªïn Th·∫•t ƒêi·ªán √Åp</h2>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Lo·∫°i m·∫°ng ƒëi·ªán</label>
                            <select id="vd-phase">
                                <option value="1">1 Pha</option>
                                <option value="3" selected>3 Pha</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>ƒêi·ªán √°p (V)</label>
                            <input type="number" id="vd-voltage" placeholder="380V" value="380">
                            <div class="quick-select">
                                <button class="quick-btn" onclick="setValue('vd-voltage', 220)">220V</button>
                                <button class="quick-btn" onclick="setValue('vd-voltage', 380)">380V</button>
                            </div>
                        </div>

                        <div class="input-group">
                            <label>D√≤ng ƒëi·ªán (A)</label>
                            <input type="number" id="vd-current" placeholder="Nh·∫≠p d√≤ng ƒëi·ªán">
                        </div>

                        <div class="input-group">
                            <label>C√¥ng su·∫•t (kW)</label>
                            <input type="number" id="vd-power" placeholder="Ho·∫∑c nh·∫≠p c√¥ng su·∫•t">
                        </div>

                        <div class="input-group">
                            <label>H·ªá s·ªë c√¥ng su·∫•t (cos œÜ)</label>
                            <input type="number" id="vd-pf" placeholder="0.8 - 1.0" value="0.85" step="0.01" min="0" max="1">
                            <div class="quick-select">
                                <button class="quick-btn" onclick="setValue('vd-pf', 0.8)">0.8</button>
                                <button class="quick-btn" onclick="setValue('vd-pf', 0.85)">0.85</button>
                                <button class="quick-btn" onclick="setValue('vd-pf', 0.9)">0.9</button>
                            </div>
                        </div>

                        <div class="input-group">
                            <label>Chi·ªÅu d√†i d√¢y (m)</label>
                            <input type="number" id="vd-length" placeholder="Nh·∫≠p chi·ªÅu d√†i">
                        </div>

                        <div class="input-group">
                            <label>Ti·∫øt di·ªán d√¢y (mm¬≤)</label>
                            <input type="number" id="vd-area" placeholder="Ti·∫øt di·ªán">
                            <div class="quick-select">
                                <button class="quick-btn" onclick="setValue('vd-area', 1.5)">1.5</button>
                                <button class="quick-btn" onclick="setValue('vd-area', 2.5)">2.5</button>
                                <button class="quick-btn" onclick="setValue('vd-area', 4)">4</button>
                                <button class="quick-btn" onclick="setValue('vd-area', 6)">6</button>
                                <button class="quick-btn" onclick="setValue('vd-area', 10)">10</button>
                                <button class="quick-btn" onclick="setValue('vd-area', 16)">16</button>
                            </div>
                        </div>

                        <div class="input-group">
                            <label>V·∫≠t li·ªáu d√¢y d·∫´n</label>
                            <select id="vd-material">
                                <option value="0.0175">ƒê·ªìng (Cu) - 0.0175 Œ©¬∑mm¬≤/m</option>
                                <option value="0.0283">Nh√¥m (Al) - 0.0283 Œ©¬∑mm¬≤/m</option>
                            </select>
                        </div>
                    </div>

                    <button class="calc-btn" onclick="calculateVoltageDrop()">
                        üîç T√çNH TO√ÅN T·ªîNG TH·∫§T ƒêI·ªÜN √ÅP
                    </button>

                    <div id="vd-result" class="result-section hidden">
                        <div class="result-title">üìä K·∫øt Qu·∫£ T√≠nh To√°n</div>
                        <div id="vd-results-container"></div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: T√çNH T·ª§ B√ô -->
            <div id="capacitor" class="tab-content">
                <div class="card">
                    <h2>üîã T√≠nh T·ª• B√π N√¢ng Cao H·ªá S·ªë C√¥ng Su·∫•t</h2>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label>C√¥ng su·∫•t th·ª±c t·∫ø (kW)</label>
                            <input type="number" id="cap-power" placeholder="Nh·∫≠p c√¥ng su·∫•t">
                        </div>

                        <div class="input-group">
                            <label>H·ªá s·ªë c√¥ng su·∫•t hi·ªán t·∫°i (cos œÜ‚ÇÅ)</label>
                            <input type="number" id="cap-pf-old" placeholder="0.7 - 0.85" step="0.01" min="0" max="1">
                            <div class="quick-select">
                                <button class="quick-btn" onclick="setValue('cap-pf-old', 0.7)">0.7</button>
                                <button class="quick-btn" onclick="setValue('cap-pf-old', 0.75)">0.75</button>
                                <button class="quick-btn" onclick="setValue('cap-pf-old', 0.8)">0.8</button>
                                <button class="quick-btn" onclick="setValue('cap-pf-old', 0.85)">0.85</button>
                            </div>
                        </div>

                        <div class="input-group">
                            <label>H·ªá s·ªë c√¥ng su·∫•t m·ª•c ti√™u (cos œÜ‚ÇÇ)</label>
                            <input type="number" id="cap-pf-new" placeholder="0.92 - 0.98" step="0.01" min="0" max="1" value="0.95">
                            <div class="quick-select">
                                <button class="quick-btn" onclick="setValue('cap-pf-new', 0.92)">0.92</button>
                                <button class="quick-btn" onclick="setValue('cap-pf-new', 0.95)">0.95</button>
                                <button class="quick-btn" onclick="setValue('cap-pf-new', 0.98)">0.98</button>
                            </div>
                        </div>

                        <div class="input-group">
                            <label>ƒêi·ªán √°p h·ªá th·ªëng (V)</label>
                            <input type="number" id="cap-voltage" placeholder="380V / 400V" value="380">
                            <div class="quick-select">
                                <button class="quick-btn" onclick="setValue('cap-voltage', 380)">380V</button>
                                <button class="quick-btn" onclick="setValue('cap-voltage', 400)">400V</button>
                            </div>
                        </div>
                    </div>

                    <button class="calc-btn" onclick="calculateCapacitor()">
                        üîç T√çNH TO√ÅN T·ª§ B√ô
                    </button>

                    <div id="cap-result" class="result-section hidden">
                        <div class="result-title">üìä K·∫øt Qu·∫£ T√≠nh To√°n</div>
                        <div id="cap-results-container"></div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: ƒê·ªòNG C∆† -->
            <div id="motor" class="tab-content">
                <div class="card">
                    <h2>üè≠ T√≠nh To√°n ƒê·ªông C∆°</h2>
                    
                    <div class="input-grid">
    <div class="input-group">
        <label>Lo·∫°i ƒë·ªông c∆°</label>
        <select id="motor-type">
            <option value="3phase">ƒê·ªông c∆° 3 pha</option>
            <option value="1phase">ƒê·ªông c∆° 1 pha</option>
        </select>
    </div>

    <div class="input-group">
        <label>Ph∆∞∆°ng ph√°p kh·ªüi ƒë·ªông</label>
        <select id="motor-start-method" onchange="updateStartFactor()">
            <option value="direct">Kh·ªüi ƒë·ªông tr·ª±c ti·∫øp (DOL)</option>
            <option value="star-delta">Kh·ªüi ƒë·ªông sao - tam gi√°c (Y-Œî)</option>
        </select>
    </div>

    <div class="input-group">
        <label>C√¥ng su·∫•t ƒë·ªông c∆° (HP ho·∫∑c kW)</label>
        <input type="number" id="motor-power" placeholder="Nh·∫≠p c√¥ng su·∫•t">
    </div>

    <div class="input-group">
        <label>ƒê∆°n v·ªã c√¥ng su·∫•t</label>
        <select id="motor-unit">
            <option value="hp">HP (Horsepower)</option>
            <option value="kw" selected>kW (Kilowatts)</option> </select>
        </select>
    </div>

    <div class="input-group">
        <label>ƒêi·ªán √°p ƒë·ªãnh m·ª©c (V)</label>
        <input type="number" id="motor-voltage" placeholder="220V / 380V" value="380">
        <div class="quick-select">
            <button class="quick-btn" onclick="setValue('motor-voltage', 220)">220V</button>
            <button class="quick-btn" onclick="setValue('motor-voltage', 380)">380V</button>
            <button class="quick-btn" onclick="setValue('motor-voltage', 400)">400V</button>
        </div>
    </div>

    <div class="input-group">
        <label>Hi·ªáu su·∫•t ƒë·ªông c∆° (%)</label>
        <input type="number" id="motor-eff" placeholder="80 - 95%" value="85" step="0.1">
        <div class="quick-select">
            <button class="quick-btn" onclick="setValue('motor-eff', 80)">80%</button>
            <button class="quick-btn" onclick="setValue('motor-eff', 85)">85%</button>
            <button class="quick-btn" onclick="setValue('motor-eff', 90)">90%</button>
            <button class="quick-btn" onclick="setValue('motor-eff', 92)">92%</button>
        </div>
    </div>

    <div class="input-group">
        <label>H·ªá s·ªë c√¥ng su·∫•t (cos œÜ)</label>
        <input type="number" id="motor-pf" placeholder="0.8 - 0.9" value="0.85" step="0.01">
        <div class="quick-select">
            <button class="quick-btn" onclick="setValue('motor-pf', 0.8)">0.8</button>
            <button class="quick-btn" onclick="setValue('motor-pf', 0.85)">0.85</button>
            <button class="quick-btn" onclick="setValue('motor-pf', 0.9)">0.9</button>
        </div>
    </div>

    <div class="input-group">
        <label>H·ªá s·ªë kh·ªüi ƒë·ªông (%)</label>
        <input type="number" id="motor-start" value="600" readonly style="background: #f0f0f0;">
        <div class="info-badge" style="margin-top: 5px;">T·ª± ƒë·ªông theo ph∆∞∆°ng ph√°p</div>
    </div>

    <div class="input-group">
        <label>T·ªëc ƒë·ªô quay (rpm) <span class="info-badge">Optional</span></label>
        <input type="number" id="motor-speed" placeholder="1450 / 2900 rpm">
        <div class="quick-select">
            <button class="quick-btn" onclick="setValue('motor-speed', 1450)">1450</button>
            <button class="quick-btn" onclick="setValue('motor-speed', 2900)">2900</button>
        </div>
    </div>
</div>

                    <button class="calc-btn" onclick="calculateMotor()">
                        üîç T√çNH TO√ÅN ƒê·ªòNG C∆†
                    </button>

                    <div id="motor-result" class="result-section hidden">
                        <div class="result-title">üìä K·∫øt Qu·∫£ T√≠nh To√°n</div>
                        <div id="motor-results-container"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <div class="footer-content">
                <h3>‚ö° M√°y T√≠nh ƒêi·ªán Chuy√™n Nghi·ªáp</h3>
                <p>C√¥ng c·ª• t√≠nh to√°n ƒëi·ªán nƒÉng ch√≠nh x√°c v√† nhanh ch√≥ng.</p>
                
                <div class="footer-info">
                    <div class="footer-item">
                        <strong>üîß T√≠nh nƒÉng</strong>
                        <span>16+ ph√©p t√≠nh</span>
                    </div>
                    <div class="footer-item">
                        <strong>‚ö° H·ªó tr·ª£</strong>
                        <span>1 & 3 Pha</span>
                    </div>
                    <div class="footer-item">
                        <strong>üíæ L∆∞u tr·ªØ</strong>
                        <span>T·ª± ƒë·ªông</span>
                    </div>
                    <div class="footer-item">
                        <strong>üì± Thi·∫øt b·ªã</strong>
                        <span>M·ªçi m√†n h√¨nh</span>
                    </div>
                </div>

                <div class="footer-badges">
                    <span class="footer-badge">‚úì Ch√≠nh x√°c cao</span>
                    <span class="footer-badge">‚úì D·ªÖ s·ª≠ d·ª•ng</span>
                    <span class="footer-badge">‚úì Ho√†n to√†n mi·ªÖn ph√≠</span>
                </div>

                <p style="margin-top: 20px; font-size: 0.95em;">
                    <strong>T·ªëi ∆∞u cho k·ªπ s∆∞ ƒëi·ªán</strong>
                </p>

                <div class="footer-copyright">
                    <p>¬© 2024 M√°y T√≠nh ƒêi·ªán NƒÉng. All rights reserved.</p>
                    <p>Ph√°t tri·ªÉn b·ªüi Nh·∫•t Nguy·ªÖn v·ªõi ‚ù§Ô∏è cho c·ªông ƒë·ªìng k·ªπ s∆∞ Vi·ªát Nam</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== NAVIGATION =====
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            
            // Close mobile menu after selection
            document.getElementById('navMenu').classList.remove('active');
        }

        function toggleMobileMenu() {
            document.getElementById('navMenu').classList.toggle('active');
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function setValue(id, value) {
            document.getElementById(id).value = value;
        }

        function getVal(id) {
            const val = parseFloat(document.getElementById(id).value);
            return isNaN(val) ? null : val;
        }

        // ===== BASIC CALCULATOR =====
        const inputIds = ['voltage', 'current', 'kw', 'kva', 'kvar', 'hp', 'pf', 'eff'];

        document.querySelectorAll('input[name="phase"]').forEach(radio => {
            radio.addEventListener('change', () => {
                updatePhaseBadges();
                if (document.getElementById('autoUpdate').checked) {
                    autoCalculateAll();
                }
                saveInputsToLocalStorage();
            });
        });

        document.querySelectorAll('.params-grid input[type="number"]').forEach(input => {
            input.addEventListener('input', () => {
                if (document.getElementById('autoUpdate').checked) {
                    autoCalculateAll();
                }
                saveInputsToLocalStorage();
            });
        });

        function updatePhaseBadges() {
            const phase = getPhase();
            const badges = document.querySelectorAll('.phase-badge');
            badges.forEach(badge => {
                if (phase === 3) {
                    badge.textContent = '3 Pha';
                    badge.className = 'phase-badge badge-3phase';
                } else {
                    badge.textContent = '1 Pha';
                    badge.className = 'phase-badge badge-1phase';
                }
            });
            const voltageInput = document.getElementById('voltage');
            if (phase === 3) {
                voltageInput.placeholder = "380V";
            } else {
                voltageInput.placeholder = "220V";
            }
        }

        function getPhase() {
            return parseInt(document.querySelector('input[name="phase"]:checked').value);
        }

        function getInput(id) {
            const value = parseFloat(document.getElementById(id).value);
            return isNaN(value) ? null : value;
        }

        function showResult(elementId, value, unit, formula, silentFail = false) {
            const resultDiv = document.getElementById(elementId);
            if (value !== null && isFinite(value)) {
                resultDiv.style.display = 'block';
                resultDiv.querySelector('.result-value').textContent = value.toFixed(2) + ' ' + unit;
                if (formula) {
                    resultDiv.querySelector('.formula').textContent = formula;
                }
            } else {
                if (!silentFail) {
                    alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß v√† ch√≠nh x√°c c√°c th√¥ng s·ªë c·∫ßn thi·∫øt!');
                }
                resultDiv.style.display = 'none';
            }
        }
// --- B·ªî SUNG LOGIC M·ªöI: T·ª∞ ƒê·ªòNG C·∫¨P NH·∫¨T PH∆Ø∆†NG PH√ÅP KH·ªûI ƒê·ªòNG ---
document.getElementById('motor-type').addEventListener('change', function() {
    const motorType = this.value;
    const startMethodSelect = document.getElementById('motor-start-method');
    const starDeltaOption = startMethodSelect.querySelector('option[value="star-delta"]');

    if (motorType === '1phase') {
        // N·∫øu ch·ªçn 1 pha:
        startMethodSelect.value = 'direct'; // B·∫Øt bu·ªôc ch·ªçn DOL
        starDeltaOption.disabled = true;  // V√¥ hi·ªáu h√≥a t√πy ch·ªçn Y-Œî
        updateStartFactor(); // C·∫≠p nh·∫≠t h·ªá s·ªë kh·ªüi ƒë·ªông v·ªÅ 600%
    } else {
        // N·∫øu ch·ªçn 3 pha:
        starDeltaOption.disabled = false; // K√≠ch ho·∫°t l·∫°i t√πy ch·ªçn Y-Œî
    }
});
// --- K·∫æT TH√öC B·ªî SUNG LOGIC M·ªöI ---
        function autoCalculateAll() {
            calcAFromKVA(true);
            calcAFromKW(true);
            calcAFromHP(true);
            calcAFromKVAR(true);
            calcKwFromIVpF(true);
            calcKwFromKVApF(true);
            calcKwFromHPEff(true);
            calcKVAFromIV(true);
            calcKVAFromKWpF(true);
            calcKVAFromHPEffpF(true);
            calcKVARFromKWKVA(true);
            calcHPFromIVEffpF(true);
            calcHPFromKVAEffpF(true);
        }

        function clearAllResults() {
            document.querySelectorAll('.result').forEach(div => {
                div.style.display = 'none';
            });
        }

        function resetAllInputs() {
            inputIds.forEach(id => {
                document.getElementById(id).value = '';
                localStorage.removeItem(id);
            });
            document.getElementById('phase3').checked = true;
            localStorage.removeItem('phase');
            updatePhaseBadges();
            clearAllResults();
        }

        function saveInputsToLocalStorage() {
            inputIds.forEach(id => {
                localStorage.setItem(id, document.getElementById(id).value);
            });
            localStorage.setItem('phase', getPhase());
        }

        function loadInputsFromLocalStorage() {
            const savedPhase = localStorage.getItem('phase');
            if (savedPhase) {
                const phaseRadio = document.getElementById(savedPhase === '1' ? 'phase1' : 'phase3');
                if (phaseRadio) phaseRadio.checked = true;
            }
            updatePhaseBadges();
            inputIds.forEach(id => {
                const savedValue = localStorage.getItem(id);
                if (savedValue !== null) {
                    document.getElementById(id).value = savedValue;
                }
            });
            autoCalculateAll();
        }

        // Basic calculation functions
        function calcKwFromIVpF(silentFail = false) {
            const v = getInput('voltage');
            const i = getInput('current');
            const pf = getInput('pf');
            const phase = getPhase();
            if (v && i && pf) {
                let kw, formula;
                if (phase === 3) {
                    kw = (Math.sqrt(3) * v * i * pf) / 1000;
                    formula = 'kW = (‚àö3 √ó V √ó I √ó pF) / 1000';
                } else {
                    kw = (v * i * pf) / 1000;
                    formula = 'kW = (V √ó I √ó pF) / 1000';
                }
                showResult('result-kw-ivpf', kw, 'kW', formula, silentFail);
            } else {
                showResult('result-kw-ivpf', null, null, null, silentFail);
            }
        }

        function calcKwFromKVApF(silentFail = false) {
            const kva = getInput('kva');
            const pf = getInput('pf');
            if (kva && pf) {
                const kw = kva * pf;
                showResult('result-kw-kvapf', kw, 'kW', null, silentFail);
            } else {
                showResult('result-kw-kvapf', null, null, null, silentFail);
            }
        }

        function calcKwFromHPEff(silentFail = false) {
            const hp = getInput('hp');
            const eff = getInput('eff');
            if (hp && eff) {
                const kw = (hp * 0.746) / (eff / 100);
                showResult('result-kw-hpeff', kw, 'kW', null, silentFail);
            } else {
                showResult('result-kw-hpeff', null, null, null, silentFail);
            }
        }

        function calcKVAFromIV(silentFail = false) {
            const v = getInput('voltage');
            const i = getInput('current');
            const phase = getPhase();
            if (v && i) {
                let kva, formula;
                if (phase === 3) {
                    kva = (Math.sqrt(3) * v * i) / 1000;
                    formula = 'kVA = (‚àö3 √ó V √ó I) / 1000';
                } else {
                    kva = (v * i) / 1000;
                    formula = 'kVA = (V √ó I) / 1000';
                }
                showResult('result-kva-iv', kva, 'kVA', formula, silentFail);
            } else {
                showResult('result-kva-iv', null, null, null, silentFail);
            }
        }

        function calcKVAFromKWpF(silentFail = false) {
            const kw = getInput('kw');
            const pf = getInput('pf');
            if (kw && pf) {
                const kva = kw / pf;
                showResult('result-kva-kwpf', kva, 'kVA', null, silentFail);
            } else {
                showResult('result-kva-kwpf', null, null, null, silentFail);
            }
        }

        function calcKVAFromHPEffpF(silentFail = false) {
            const hp = getInput('hp');
            const eff = getInput('eff');
            const pf = getInput('pf');
            if (hp && eff && pf) {
                const kva = (hp * 0.746) / ((eff / 100) * pf);
                showResult('result-kva-hpeffpf', kva, 'kVA', null, silentFail);
            } else {
                showResult('result-kva-hpeffpf', null, null, null, silentFail);
            }
        }

        function calcAFromKVA(silentFail = false) {
            const kva = getInput('kva');
            const v = getInput('voltage');
            const phase = getPhase();
            if (kva && v) {
                let a, formula;
                if (phase === 3) {
                    a = (kva * 1000) / (Math.sqrt(3) * v);
                    formula = 'A = (kVA √ó 1000) / (‚àö3 √ó V)';
                } else {
                    a = (kva * 1000) / v;
                    formula = 'A = (kVA √ó 1000) / V';
                }
                showResult('result-a-kva', a, 'A', formula, silentFail);
            } else {
                showResult('result-a-kva', null, null, null, silentFail);
            }
        }

        function calcAFromKW(silentFail = false) {
            const kw = getInput('kw');
            const v = getInput('voltage');
            const pf = getInput('pf');
            const phase = getPhase();
            if (kw && v && pf) {
                let a, formula;
                if (phase === 3) {
                    a = (kw * 1000) / (Math.sqrt(3) * v * pf);
                    formula = 'A = (kW √ó 1000) / (‚àö3 √ó V √ó pF)';
                } else {
                    a = (kw * 1000) / (v * pf);
                    formula = 'A = (kW √ó 1000) / (V √ó pF)';
                }
                showResult('result-a-kw', a, 'A', formula, silentFail);
            } else {
                showResult('result-a-kw', null, null, null, silentFail);
            }
        }

        function calcAFromHP(silentFail = false) {
            const hp = getInput('hp');
            const v = getInput('voltage');
            const eff = getInput('eff');
            const pf = getInput('pf');
            const phase = getPhase();
            if (hp && v && eff && pf) {
                let a, formula;
                if (phase === 3) {
                    a = (hp * 746) / (Math.sqrt(3) * v * (eff / 100) * pf);
                    formula = 'A = (HP √ó 746) / (‚àö3 √ó V √ó Eff √ó pF)';
                } else {
                    a = (hp * 746) / (v * (eff / 100) * pf);
                    formula = 'A = (HP √ó 746) / (V √ó Eff √ó pF)';
                }
                showResult('result-a-hp', a, 'A', formula, silentFail);
            } else {
                showResult('result-a-hp', null, null, null, silentFail);
            }
        }

        function calcAFromKVAR(silentFail = false) {
            const kvar = getInput('kvar');
            const v = getInput('voltage');
            const phase = getPhase();
            if (kvar && v) {
                let a, formula;
                if (phase === 3) {
                    a = (kvar * 1000) / (Math.sqrt(3) * v);
                    formula = 'A = (kVAR √ó 1000) / (‚àö3 √ó V)';
                } else {
                    a = (kvar * 1000) / v;
                    formula = 'A = (kVAR √ó 1000) / V';
                }
                showResult('result-a-kvar', a, 'A', formula, silentFail);
            } else {
                showResult('result-a-kvar', null, null, null, silentFail);
            }
        }

        function calcHPFromIVEffpF(silentFail = false) {
            const i = getInput('current');
            const v = getInput('voltage');
            const eff = getInput('eff');
            const pf = getInput('pf');
            const phase = getPhase();
            if (i && v && eff && pf) {
                let hp, formula;
                if (phase === 3) {
                    hp = (Math.sqrt(3) * v * i * pf * (eff / 100)) / 746;
                    formula = 'HP = (‚àö3 √ó V √ó I √ó pF √ó Eff) / 746';
                } else {
                    hp = (v * i * pf * (eff / 100)) / 746;
                    formula = 'HP = (V √ó I √ó pF √ó Eff) / 746';
                }
                showResult('result-hp-iveffpf', hp, 'HP', formula, silentFail);
            } else {
                showResult('result-hp-iveffpf', null, null, null, silentFail);
            }
        }

        function calcHPFromKVAEffpF(silentFail = false) {
            const kva = getInput('kva');
            const eff = getInput('eff');
            const pf = getInput('pf');
            if (kva && eff && pf) {
                const hp = (kva * 1000 * pf * (eff / 100)) / 746;
                const formula = 'HP = (kVA √ó 1000 √ó pF √ó Eff) / 746';
                showResult('result-hp-kvaeffpf', hp, 'HP', formula, silentFail);
            } else {
                showResult('result-hp-kvaeffpf', null, null, null, silentFail);
            }
        }

        function calcKVARFromKWKVA(silentFail = false) {
            const kw = getInput('kw');
            const kva = getInput('kva');
            if (kw && kva && kva >= kw) {
                const kvar = Math.sqrt(Math.pow(kva, 2) - Math.pow(kw, 2));
                showResult('result-kvar-kwkva', kvar, 'kVAR', null, silentFail);
            } else {
                showResult('result-kvar-kwkva', null, null, null, silentFail);
            }
        }

        // ===== ADVANCED CALCULATOR FUNCTIONS =====

        // T√≠nh t·ªïn th·∫•t ƒëi·ªán √°p
        function calculateVoltageDrop() {
            const phase = parseInt(document.getElementById('vd-phase').value);
            const voltage = getVal('vd-voltage');
            let current = getVal('vd-current');
            const power = getVal('vd-power');
            const pf = getVal('vd-pf');
            const length = getVal('vd-length');
            const area = getVal('vd-area');
            const resistivity = parseFloat(document.getElementById('vd-material').value);

            if (!current && power && voltage && pf) {
                if (phase === 3) {
                    current = (power * 1000) / (Math.sqrt(3) * voltage * pf);
                } else {
                    current = (power * 1000) / (voltage * pf);
                }
            }

            if (!current || !voltage || !length || !area || !pf) {
                alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng s·ªë!');
                return;
            }

            const resistance = (resistivity * length) / area;
            let voltageDrop;
            if (phase === 3) {
                voltageDrop = Math.sqrt(3) * current * resistance;
            } else {
                voltageDrop = 2 * current * resistance;
            }

            const voltageDropPercent = (voltageDrop / voltage) * 100;
            const powerLoss = current * current * resistance / 1000;

            let assessment = '';
            let assessmentClass = '';
            if (voltageDropPercent <= 3) {
                assessment = '‚úÖ ƒê·∫°t ti√™u chu·∫©n! T·ªïn th·∫•t ƒëi·ªán √°p n·∫±m trong gi·ªõi h·∫°n cho ph√©p (‚â§ 3%)';
                assessmentClass = 'success';
            } else if (voltageDropPercent <= 5) {
                assessment = '‚ö†Ô∏è Ch·∫•p nh·∫≠n ƒë∆∞·ª£c nh∆∞ng n√™n c·∫£i thi·ªán. T·ªïn th·∫•t t·ª´ 3-5%';
                assessmentClass = 'warning';
            } else {
                assessment = '‚ùå Kh√¥ng ƒë·∫°t! T·ªïn th·∫•t qu√° cao (> 5%). C·∫ßn tƒÉng ti·∫øt di·ªán d√¢y ho·∫∑c gi·∫£m chi·ªÅu d√†i';
                assessmentClass = 'warning';
            }

            let suggestedArea = area;
            if (voltageDropPercent > 3) {
                suggestedArea = Math.ceil((area * voltageDropPercent) / 3);
            }

            const resultHTML = `
                <div class="result-item">
                    <span class="result-label">D√≤ng ƒëi·ªán t√≠nh to√°n:</span>
                    <span class="result-value">${current.toFixed(2)} A</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ƒêi·ªán tr·ªü d√¢y d·∫´n:</span>
                    <span class="result-value">${resistance.toFixed(4)} Œ©</span>
                </div>
                <div class="result-item">
                    <span class="result-label">T·ªïn th·∫•t ƒëi·ªán √°p:</span>
                    <span class="result-value">${voltageDrop.toFixed(2)} V</span>
                </div>
                <div class="result-item">
                    <span class="result-label">T·ªïn th·∫•t ƒëi·ªán √°p (%):</span>
                    <span class="result-value">${voltageDropPercent.toFixed(2)} %</span>
                </div>
                <div class="result-item">
                    <span class="result-label">C√¥ng su·∫•t t·ªïn th·∫•t:</span>
                    <span class="result-value">${powerLoss.toFixed(3)} kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ƒêi·ªán √°p t·∫°i t·∫£i:</span>
                    <span class="result-value">${(voltage - voltageDrop).toFixed(2)} V</span>
                </div>
                <div class="${assessmentClass}">
                    <strong>ƒê√°nh gi√°:</strong> ${assessment}
                </div>
                ${voltageDropPercent > 3 ? `
                <div class="warning">
                    <strong>üí° G·ª£i √Ω:</strong> N√™n d√πng d√¢y ti·∫øt di·ªán t·ªëi thi·ªÉu <strong>${suggestedArea} mm¬≤</strong> ƒë·ªÉ ƒë·∫°t ti√™u chu·∫©n ‚â§ 3%
                </div>
                ` : ''}
                <div class="formula-box">
                    <strong>C√¥ng th·ª©c:</strong><br>
                    ${phase === 3 ? 
                        'ŒîV = ‚àö3 √ó I √ó R (3 pha)<br>' :
                        'ŒîV = 2 √ó I √ó R (1 pha)<br>'
                    }
                    R = œÅ √ó L / A<br>
                    ŒîV% = (ŒîV / V) √ó 100%
                </div>
            `;

            document.getElementById('vd-results-container').innerHTML = resultHTML;
            document.getElementById('vd-result').classList.remove('hidden');
        }

        // T√≠nh t·ª• b√π
        function calculateCapacitor() {
            const power = getVal('cap-power');
            const pfOld = getVal('cap-pf-old');
            const pfNew = getVal('cap-pf-new');
            const voltage = getVal('cap-voltage');

            if (!power || !pfOld || !pfNew || !voltage) {
                alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng s·ªë!');
                return;
            }

            if (pfNew <= pfOld) {
                alert('H·ªá s·ªë c√¥ng su·∫•t m·ª•c ti√™u ph·∫£i l·ªõn h∆°n h·ªá s·ªë c√¥ng su·∫•t hi·ªán t·∫°i!');
                return;
            }

            const theta1 = Math.acos(pfOld);
            const theta2 = Math.acos(pfNew);
            const tan1 = Math.tan(theta1);
            const tan2 = Math.tan(theta2);
            const Qc = power * (tan1 - tan2);
            const capacitance = (Qc * Math.pow(10, 9)) / (2 * Math.PI * 50 * voltage * voltage);

            const currentOld = (power * 1000) / (Math.sqrt(3) * voltage * pfOld);
            const currentNew = (power * 1000) / (Math.sqrt(3) * voltage * pfNew);
            const currentSaved = currentOld - currentNew;
            const percentSaved = ((currentOld - currentNew) / currentOld) * 100;

            const kvaOld = power / pfOld;
            const kvaNew = power / pfNew;
            const kvaSaved = kvaOld - kvaNew;

            const standardCapacitors = [5, 10, 15, 20, 25, 30, 40, 50, 60, 75, 100];
            let suggestedCap = standardCapacitors.find(cap => cap >= Qc);
            if (!suggestedCap) suggestedCap = Math.ceil(Qc / 50) * 50;

            const resultHTML = `
                <div class="result-item">
                    <span class="result-label">C√¥ng su·∫•t ph·∫£n kh√°ng c·∫ßn b√π:</span>
                    <span class="result-value">${Qc.toFixed(2)} kVAR</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Dung l∆∞·ª£ng t·ª• b√π (3 pha):</span>
                    <span class="result-value">${capacitance.toFixed(2)} ¬µF</span>
                </div>
                <div class="success">
                    <strong>üí° G·ª£i √Ω:</strong> N√™n d√πng t·ª• b√π c√¥ng su·∫•t <strong>${suggestedCap} kVAR</strong> (Gi√° tr·ªã ti√™u chu·∫©n g·∫ßn nh·∫•t)
                </div>
                
                <div class="result-title" style="margin-top: 25px;">üìä So S√°nh Tr∆∞·ªõc & Sau Khi B√π</div>
                
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Th√¥ng s·ªë</th>
                                <th>Tr∆∞·ªõc khi b√π</th>
                                <th>Sau khi b√π</th>
                                <th>Ti·∫øt ki·ªám</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>H·ªá s·ªë c√¥ng su·∫•t</td>
                                <td>${pfOld.toFixed(3)}</td>
                                <td>${pfNew.toFixed(3)}</td>
                                <td style="color: #28a745; font-weight: bold;">+${((pfNew - pfOld) / pfOld * 100).toFixed(1)}%</td>
                            </tr>
                            <tr>
                                <td>D√≤ng ƒëi·ªán (A)</td>
                                <td>${currentOld.toFixed(2)} A</td>
                                <td>${currentNew.toFixed(2)} A</td>
                                <td style="color: #28a745; font-weight: bold;">-${currentSaved.toFixed(2)} A (${percentSaved.toFixed(1)}%)</td>
                            </tr>
                            <tr>
                                <td>C√¥ng su·∫•t bi·ªÉu ki·∫øn (kVA)</td>
                                <td>${kvaOld.toFixed(2)} kVA</td>
                                <td>${kvaNew.toFixed(2)} kVA</td>
                                <td style="color: #28a745; font-weight: bold;">-${kvaSaved.toFixed(2)} kVA</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="success" style="margin-top: 20px;">
                    <strong>‚úÖ L·ª£i √≠ch:</strong><br>
                    ‚Ä¢ Gi·∫£m d√≤ng ƒëi·ªán ${percentSaved.toFixed(1)}% ‚Üí Gi·∫£m t·ªïn th·∫•t ƒë∆∞·ªùng d√¢y<br>
                    ‚Ä¢ TƒÉng kh·∫£ nƒÉng truy·ªÅn t·∫£i c·ªßa h·ªá th·ªëng<br>
                    ‚Ä¢ Gi·∫£m chi ph√≠ ti·ªÅn ƒëi·ªán (tr√°nh ph·∫°t cosœÜ th·∫•p)<br>
                    ‚Ä¢ K√©o d√†i tu·ªïi th·ªç thi·∫øt b·ªã ƒëi·ªán
                </div>

                <div class="formula-box">
                    <strong>C√¥ng th·ª©c:</strong><br>
                    Qc = P √ó (tan œÜ‚ÇÅ - tan œÜ‚ÇÇ) (kVAR)<br>
                    C = Qc √ó 10‚Åπ / (2œÄ √ó f √ó V¬≤) (¬µF)<br>
                    Trong ƒë√≥: f = 50Hz (t·∫ßn s·ªë l∆∞·ªõi ƒëi·ªán VN)
                </div>
            `;

            document.getElementById('cap-results-container').innerHTML = resultHTML;
            document.getElementById('cap-result').classList.remove('hidden');
        }
		// C·∫≠p nh·∫≠t h·ªá s·ªë kh·ªüi ƒë·ªông
		function updateStartFactor() {
			const method = document.getElementById('motor-start-method').value;
			const startInput = document.getElementById('motor-start');
    
			if (method === 'direct') {
			startInput.value = 600; // DOL: 6 l·∫ßn
			} else {
			startInput.value = 200; // Y-Œî: 2 l·∫ßn
				}
				}
        // T√≠nh ƒë·ªông c∆°
        // T√≠nh ƒë·ªông c∆°
// T√≠nh ƒë·ªông c∆°
function calculateMotor() {
    const motorType = document.getElementById('motor-type').value;
    let startMethod = document.getElementById('motor-start-method').value; // ƒê·ªïi th√†nh 'let'
    let power = getVal('motor-power');
    const unit = document.getElementById('motor-unit').value;
    const voltage = getVal('motor-voltage');
    const eff = getVal('motor-eff');
    const pf = getVal('motor-pf');
    let startFactor = getVal('motor-start') || 600; // ƒê·ªïi th√†nh 'let'
    const speed = getVal('motor-speed');

    // --- LOGIC M·ªöI: B·∫ÆT BU·ªòC DOL CHO 1 PHA ---
    if (motorType === '1phase') {
        startMethod = 'direct'; // B·∫Øt bu·ªôc l√† DOL
        startFactor = 600;      // B·∫Øt bu·ªôc h·ªá s·ªë 600%
    }
    // --- K·∫æT TH√öC LOGIC M·ªöI ---

    if (!power || !voltage || !eff || !pf) {
        alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng s·ªë c∆° b·∫£n!');
        return;
    }

    let powerKW = power;
    let powerHP = power;
    if (unit === 'hp') {
        powerKW = power * 0.746;
    } else {
        powerHP = power / 0.746;
    }

    let ratedCurrent;
    if (motorType === '3phase') {
        ratedCurrent = (powerKW * 1000) / (Math.sqrt(3) * voltage * (eff / 100) * pf);
    } else {
        ratedCurrent = (powerKW * 1000) / (voltage * (eff / 100) * pf);
    }

    // T√≠nh l·∫°i d√≤ng kh·ªüi ƒë·ªông sau khi ƒë√£ √©p h·ªá s·ªë (n·∫øu c·∫ßn)
    const startCurrent = ratedCurrent * (startFactor / 100);
    const inputPower = powerKW / (eff / 100);

    let torque = null;
    if (speed) {
        torque = (9550 * powerKW) / speed;
    }

    // (ƒê√¢y l√† logic ƒë√£ s·ª≠a l·ªói t·ª´ l·∫ßn tr∆∞·ªõc)
    let cbRating;
    let startMethodName, startMethodDesc;
    let additionalEquipment = '';
    let thermalMin, thermalMax; // Bi·∫øn OLR chung

    if (startMethod === 'direct') {
        // --- LOGIC CHO DOL (S·∫Ω lu√¥n ƒë√∫ng cho 1 pha) ---
        
        cbRating = Math.ceil(ratedCurrent * 1.25 / 5) * 5;
        const contactorRating = Math.ceil(ratedCurrent * 1.1 / 5) * 5;
        
        startMethodName = 'Kh·ªüi ƒë·ªông tr·ª±c ti·∫øp (DOL)';
        startMethodDesc = 'ƒê·ªông c∆° n·ªëi tr·ª±c ti·∫øp v√†o l∆∞·ªõi, d√≤ng kh·ªüi ƒë·ªông l·ªõn';
        
        additionalEquipment = `
            <tr>
                <td><strong>Contactor ch√≠nh</strong></td>
                <td>${contactorRating} A</td>
                <td>KM (AC3)</td>
            </tr>
        `;

        // T√≠nh OLR cho DOL (ƒë·∫∑t ·ªü t·ªïng, 100% d√≤ng ƒë·ªãnh m·ª©c)
        thermalMin = ratedCurrent * 0.8;
        thermalMax = ratedCurrent * 1.1;

    } else {
        // --- LOGIC CHO Y-Œî (Gi·ªù ƒë√¢y ch·ªâ ch·∫°y cho 3 pha) ---
        
        const mainContactor = Math.ceil(ratedCurrent * 0.58 * 1.1 / 5) * 5;
        const starContactor = Math.ceil(ratedCurrent * 0.33 * 1.1 / 5) * 5;
        const deltaContactor = Math.ceil(ratedCurrent * 0.58 * 1.1 / 5) * 5;

        cbRating = Math.ceil(ratedCurrent * 1.25 / 5) * 5;

        // T√≠nh OLR cho Y-Œî (ƒë·∫∑t ·ªü nh√°nh, 58% d√≤ng ƒë·ªãnh m·ª©c)
        thermalMin = ratedCurrent * 0.58 * 0.8;
        thermalMax = ratedCurrent * 0.58 * 1.1;

        startMethodName = 'Kh·ªüi ƒë·ªông sao - tam gi√°c (Y-Œî)';
        startMethodDesc = 'KM Main ‚âà 0.58√óIn, KM Star ‚âà 0.33√óIn, KM Delta ‚âà 0.58√óIn, OLR ƒë·∫∑t nh√°nh = 0.58√óIn';

        additionalEquipment = `
            <tr>
                <td><strong>Contactor Line (Main)</strong></td>
                <td>${mainContactor} A</td>
                <td>KM (AC-3)</td>
            </tr>
            <tr>
                <td><strong>Contactor Delta (Œî)</strong></td>
                <td>${deltaContactor} A</td>
                <td>KD (AC-3)</td>
            </tr>
            <tr>
                <td><strong>Contactor Star (Y)</strong></td>
                <td>${starContactor} A</td>
                <td>KY (AC-3)</td>
            </tr>
            <tr>
                <td><strong>Timer Relay</strong></td>
                <td>3‚Äì30s</td>
                <td>Th·ªùi gian Y‚ÜíŒî</td>
            </tr>
        `;
    }

    // T·∫°o HTML k·∫øt qu·∫£
    const resultHTML = `
        <div class="success" style="margin-bottom: 20px;">
            <strong>üîå ${startMethodName}</strong><br>
            ${startMethodDesc}
        </div>

        <div class="grid-2col">
            <div>
                <div class="result-title">‚ö° Th√¥ng S·ªë ƒêi·ªán</div>
                <div class="result-item">
                    <span class="result-label">C√¥ng su·∫•t:</span>
                    <span class="result-value">${powerKW.toFixed(2)} kW / ${powerHP.toFixed(2)} HP</span>
                </div>
                <div class="result-item">
                    <span class="result-label">D√≤ng ƒë·ªãnh m·ª©c:</span>
                    <span class="result-value">${ratedCurrent.toFixed(2)} A</span>
                </div>
                <div class="result-item">
                    <span class="result-label">D√≤ng kh·ªüi ƒë·ªông:</span>
                    <span class="result-value">${startCurrent.toFixed(2)} A</span>
                </div>
                <div class="result-item">
                    <span class="result-label">C√¥ng su·∫•t ti√™u th·ª•:</span>
                    <span class="result-value">${inputPower.toFixed(2)} kW</span>
                </div>
                ${torque ? `
                <div class="result-item">
                    <span class="result-label">Moment xo·∫Øn:</span>
                    <span class="result-value">${torque.toFixed(2)} N¬∑m</span>
                </div>
                ` : ''}
            </div>

            <div>
                <div class="result-title">üîß Thi·∫øt B·ªã B·∫£o V·ªá</div>
                <div class="result-item">
                    <span class="result-label">CB/MCCB:</span>
                    <span class="result-value">${cbRating} A</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Thermal Relay:</span>
                    <span class="result-value">${thermalMin.toFixed(1)} - ${thermalMax.toFixed(1)} A</span>
                </div>
            </div>
        </div>

        <div class="result-title" style="margin-top: 25px;">üìä B·∫£ng Thi·∫øt B·ªã</div>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Thi·∫øt b·ªã</th>
                        <th>Th√¥ng s·ªë</th>
                        <th>Ghi ch√∫</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ƒê·ªông c∆°</strong></td>
                        <td>${powerKW.toFixed(2)} kW / ${powerHP.toFixed(2)} HP</td>
                        <td>${voltage}V, ${motorType === '3phase' ? '3 pha' : '1 pha'}${startMethod === 'star-delta' ? ', 6 ƒë·∫ßu d√¢y' : ''}</td>
                    </tr>
                    <tr>
                        <td><strong>CB/MCCB</strong></td>
                        <td>${cbRating} A</td>
                        <td>${motorType === '3phase' ? `${voltage}V, 3 pha` : `${voltage}V, 2P (1 pha)`}</td>
                    </tr>
                    
                    ${additionalEquipment} 
                    
                    <tr>
                        <td><strong>Thermal Relay</strong></td>
                        <td>${thermalMin.toFixed(1)}-${thermalMax.toFixed(1)} A</td>
                        <td>${startMethod === 'star-delta' ? 'R∆° le nhi·ªát (ƒë·∫∑t ·ªü nh√°nh 58%)' : 'R∆° le nhi·ªát (ƒë·∫∑t ·ªü t·ªïng 100%)'}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        ${startMethod === 'star-delta' ? `
        <div class="warning" style="margin-top: 20px;">
            <strong>‚ö†Ô∏è ƒêi·ªÅu ki·ªán Y-Œî:</strong><br>
            ‚Ä¢ ƒê·ªông c∆° ph·∫£i c√≥ 6 ƒë·∫ßu d√¢y<br>
            ‚Ä¢ Ch·∫°y ·ªü ch·∫ø ƒë·ªô Œî v·ªõi ƒëi·ªán √°p l∆∞·ªõi<br>
            ‚Ä¢ T·ª´ 5HP (3.7kW) tr·ªü l√™n<br>
            ‚Ä¢ Moment kh·ªüi ƒë·ªông gi·∫£m 33%<br>
            ‚Ä¢ OLR n√™n ƒë·∫∑t ·ªü nh√°nh (t√≠nh 58% I<sub>dm</sub>)
        </div>
        ` : `
        <div class="warning" style="margin-top: 20px;">
            <strong>‚ö†Ô∏è L∆∞u √Ω DOL:</strong><br>
            ‚Ä¢ D√≤ng kh·ªüi ƒë·ªông 5-7 l·∫ßn<br>
            ‚Ä¢ C√≥ th·ªÉ g√¢y s·ª•t √°p<br>
            ‚Ä¢ D√πng cho ƒë·ªông c∆° < 5HP<br>
            ‚Ä¢ Moment kh·ªüi ƒë·ªông cao
        </div>
        `}

        <div class="formula-box">
            <strong>C√¥ng th·ª©c:</strong><br>
            ${motorType === '3phase' ? 'I = P / (‚àö3 √ó V √ó Œ∑ √ó cosœÜ)' : 'I = P / (V √ó Œ∑ √ó cosœÜ)'}<br>
            ${startMethod === 'direct' ? 
                'I<sub>start</sub> = 6 √ó I<sub>rated</sub> (DOL)' :
                'I<sub>start</sub> = 2 √ó I<sub>rated</sub> (Y-Œî)'
            }
        </div>
    `;

    document.getElementById('motor-results-container').innerHTML = resultHTML;
    document.getElementById('motor-result').classList.remove('hidden');
}

        // Load data on page load
        loadInputsFromLocalStorage();
    </script>
</body>
</html>



